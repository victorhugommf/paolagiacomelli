!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=wp,n=e.n(t),r=window.wp.element,i=window.lodash;const{getProtocol:o,isValidProtocol:s,getAuthority:l,isValidAuthority:a,getPath:d,isValidPath:c,getQueryString:u,isValidQueryString:p,getFragment:h,isValidFragment:g}=n().url,{useMemo:m,useState:k}=n().element,{__:__}=n().i18n,{withSpokenMessages:f,Popover:w}=n().components,{prependHTTP:b}=n().url,{create:v,insert:y,isCollapsed:L,applyFormat:E}=n().richText,{__experimentalLinkControl:S}=n().blockEditor,C=S,N=[{id:"opensInNewTab",title:__("Open in new tab")},{id:"relSponsored",title:__("Sponsored link")},{id:"relUgc",title:__("User generated content")},{id:"relNofollow",title:__("Nofollow")}];var T=f((function(e){let{isActive:t,activeAttributes:n,addingLink:f,value:S,onChange:T,speak:A,stopAddingLink:_}=e;const F=m(i.uniqueId,[f]),[x,U]=k(),R=m((()=>{const e=window.getSelection();if(!e.rangeCount)return;const n=e.getRangeAt(0);if(f&&!t)return n;let r=n.startContainer;for(r=r.nextElementSibling||r;r.nodeType!==window.Node.ELEMENT_NODE;)r=r.parentNode;return r.closest("a")}),[f,S.start,S.end]),P={url:n.url,type:n.type,id:n.id,opensInNewTab:"_blank"===n.target,relSponsored:!!n.rel&&n.rel.includes("sponsored"),relUgc:!!n.rel&&n.rel.includes("ugc"),relNofollow:!!n.rel&&n.rel.includes("nofollow"),...x};return(0,r.createElement)(w,{key:F,anchorRef:R,focusOnMount:!!f&&"firstElement",onClose:_,position:"bottom center"},(0,r.createElement)(C,{value:P,onChange:function(e){e={...x,...e};const n=(P.opensInNewTab!==e.opensInNewTab||P.relSponsored!==e.relSponsored||P.relUgc!==e.relUgc||P.relNofollow!==e.relNofollow)&&P.url===e.url,r=n&&void 0===e.url;if(U(r?e:void 0),r)return;const m=b(e.url),k=function(e){let{url:t,type:n,id:r,opensInNewWindow:i,relSponsored:o,relUgc:s,relNofollow:l}=e;const a={type:"core/link",attributes:{url:t}};n&&(a.attributes.type=n),r&&(a.attributes.id=r);let d=[];return i&&(a.attributes.target="_blank",d.push("noreferrer"),d.push("noopener")),o&&d.push("sponsored"),s&&d.push("ugc"),l&&d.push("nofollow"),d.length&&(a.attributes.rel=d.join(" ")),a}({url:m,type:e.type,id:void 0!==e.id&&null!==e.id?String(e.id):void 0,opensInNewWindow:e.opensInNewTab,relSponsored:e.relSponsored,relUgc:e.relUgc,relNofollow:e.relNofollow});if(L(S)&&!t){const t=e.title||m,n=E(v({text:t}),k,0,t.length);T(y(S,n))}else{const e=E(S,k);e.start=e.end,e.activeFormats=[],T(e)}n||_(),function(e){if(!e)return!1;const t=e.trim();if(!t)return!1;if(/^\S+:/.test(t)){const e=o(t);if(!s(e))return!1;if((0,i.startsWith)(e,"http")&&!/^https?:\/\/[^\/\s]/i.test(t))return!1;const n=l(t);if(!a(n))return!1;const r=d(t);if(r&&!c(r))return!1;const m=u(t);if(m&&!p(m))return!1;const k=h(t);if(k&&!g(k))return!1}return!((0,i.startsWith)(t,"#")&&!g(t))}(m)?A(__(t?"Link edited.":"Link inserted."),"assertive"):A(__("Warning: the link has been inserted but may have errors. Please test it."),"assertive")},settings:N,forceIsEditingLink:f}))}));const{__:A}=n().i18n,{Component:_}=n().element,{withSpokenMessages:F}=n().components,{getTextContent:x,applyFormat:U,removeFormat:R,slice:P,isCollapsed:I}=n().richText,{isURL:M,isEmail:O}=n().url,{RichTextToolbarButton:V,RichTextShortcut:W}=n().blockEditor,{decodeEntities:j}=n().htmlEntities,Q="core/link",q=A("Link"),B={name:Q,title:q,tagName:"a",className:null,attributes:{url:"href",type:"data-type",id:"data-id",target:"target",rel:"rel"},__unstablePasteRule(e,t){let{html:n,plainText:r}=t;if(I(e))return e;const i=(n||r).replace(/<[^>]+>/g,"").trim();return M(i)?(window.console.log("Created link:\n\n",i),U(e,{type:Q,attributes:{url:j(i)}})):e},edit:F(class extends _{constructor(){super(...arguments),this.addLink=this.addLink.bind(this),this.stopAddingLink=this.stopAddingLink.bind(this),this.onRemoveFormat=this.onRemoveFormat.bind(this),this.state={addingLink:!1}}addLink(){const{value:e,onChange:t}=this.props,n=x(P(e));n&&M(n)?t(U(e,{type:Q,attributes:{url:n}})):n&&O(n)?t(U(e,{type:Q,attributes:{url:`mailto:${n}`}})):this.setState({addingLink:!0})}stopAddingLink(){this.setState({addingLink:!1}),this.props.onFocus()}onRemoveFormat(){const{value:e,onChange:t,speak:n}=this.props;t(R(e,Q)),n(A("Link removed."),"assertive")}render(){const{isActive:e,activeAttributes:t,value:n,onChange:i}=this.props;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(W,{type:"primary",character:"k",onUse:this.addLink}),(0,r.createElement)(W,{type:"primaryShift",character:"k",onUse:this.onRemoveFormat}),e&&(0,r.createElement)(V,{name:"link",icon:"editor-unlink",title:A("Unlink"),onClick:this.onRemoveFormat,isActive:e,shortcutType:"primaryShift",shortcutCharacter:"k"}),!e&&(0,r.createElement)(V,{name:"link",icon:"admin-links",title:q,onClick:this.addLink,isActive:e,shortcutType:"primary",shortcutCharacter:"k"}),(this.state.addingLink||e)&&(0,r.createElement)(T,{addingLink:this.state.addingLink,stopAddingLink:this.stopAddingLink,isActive:e,activeAttributes:t,value:n,onChange:i}))}})};if(((n()||{}).blockEditor||{}).__experimentalLinkControl){const{registerFormatType:e,unregisterFormatType:t}=n().richText;[B].forEach((n=>{let{name:r,...i}=n;t(r),e(r,i)}))}else console.log("SmartCrawl: wp.blockEditor.__experimentalLinkControl not found")}();